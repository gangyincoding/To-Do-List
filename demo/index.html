<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskAI æŠ€æœ¯éªŒè¯ Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        .main-container {
            padding: 50px 20px;
        }
        .demo-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .voice-btn {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-size: 18px;
            transition: all 0.3s ease;
            margin: 20px;
        }
        .voice-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .voice-btn.recording {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(245, 87, 108, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(245, 87, 108, 0); }
            100% { box-shadow: 0 0 0 0 rgba(245, 87, 108, 0); }
        }
        .status-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 100px;
        }
        .task-item {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .section-title {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .api-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            margin: 5px;
        }
        .status-connected { background: #d4edda; color: #155724; }
        .status-disconnected { background: #f8d7da; color: #721c24; }
        .status-testing { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <div class="container main-container">
        <div class="demo-card">
            <h1 class="text-center mb-4">ğŸ¤ TaskAI æŠ€æœ¯éªŒè¯ Demo</h1>
            <p class="text-center text-muted mb-5">éªŒè¯è¯­éŸ³è¯†åˆ« + AIä»»åŠ¡æ‹†åˆ†çš„æŠ€æœ¯å¯è¡Œæ€§</p>

            <!-- APIçŠ¶æ€ç›‘æ§ -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <h6 class="section-title">APIè¿æ¥çŠ¶æ€</h6>
                    <div>
                        <span class="api-status status-disconnected" id="xfyun-status">ç§‘å¤§è®¯é£: æœªè¿æ¥</span>
                        <span class="api-status status-disconnected" id="baidu-status">ç™¾åº¦AI: æœªè¿æ¥</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <h6 class="section-title">æµ‹è¯•ç»Ÿè®¡</h6>
                    <div>
                        <small class="text-muted">
                            æµ‹è¯•æ¬¡æ•°: <span id="test-count">0</span> |
                            æˆåŠŸç‡: <span id="success-rate">0%</span>
                        </small>
                    </div>
                </div>
            </div>

            <!-- è¯­éŸ³å½•åˆ¶åŒºåŸŸ -->
            <div class="text-center mb-4">
                <h6 class="section-title">ğŸ™ï¸ è¯­éŸ³è¾“å…¥æµ‹è¯•</h6>
                <button class="voice-btn" id="record-btn">
                    <div id="btn-text">ç‚¹å‡»å½•éŸ³</div>
                    <small id="btn-status">å‡†å¤‡å°±ç»ª</small>
                </button>
            </div>

            <!-- çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ -->
            <div class="status-box">
                <h6 class="section-title">ğŸ“Š å®æ—¶çŠ¶æ€</h6>
                <div id="status-log">
                    <p class="text-muted">ç­‰å¾…å¼€å§‹è¯­éŸ³è¯†åˆ«æµ‹è¯•...</p>
                </div>
            </div>

            <!-- è¯­éŸ³è¯†åˆ«ç»“æœ -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <h6 class="section-title">ğŸ”¤ è¯­éŸ³è¯†åˆ«ç»“æœ</h6>
                    <div class="status-box" id="voice-result">
                        <p class="text-muted">è¯­éŸ³è¯†åˆ«ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <h6 class="section-title">ğŸ¤– AIä»»åŠ¡æ‹†åˆ†ç»“æœ</h6>
                    <div class="status-box" id="ai-result">
                        <p class="text-muted">AIæ‹†åˆ†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
                    </div>
                </div>
            </div>

            <!-- ä»»åŠ¡åˆ—è¡¨å±•ç¤º -->
            <div class="mb-4">
                <h6 class="section-title">ğŸ“‹ ç”Ÿæˆçš„ä»»åŠ¡åˆ—è¡¨</h6>
                <div id="task-list">
                    <p class="text-muted">ä»»åŠ¡åˆ—è¡¨å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
                </div>
            </div>

            <!-- æµ‹è¯•ç”¨ä¾‹ -->
            <div class="mb-4">
                <h6 class="section-title">ğŸ§ª æ¨èæµ‹è¯•ç”¨ä¾‹</h6>
                <div class="row">
                    <div class="col-md-4">
                        <button class="btn btn-outline-primary btn-sm w-100 mb-2" onclick="useTestCase('ä»Šå¤©ä¸‹åˆä¸‰ç‚¹è¦å¼€äº§å“è¯„å®¡ä¼šè®®ï¼Œéœ€è¦å‡†å¤‡PPTå’Œæ•°æ®æŠ¥å‘Š')">
                            å·¥ä½œä»»åŠ¡
                        </button>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-outline-success btn-sm w-100 mb-2" onclick="useTestCase('æ˜å¤©è¦å‡†å¤‡ä¸€é¡¿ä¸°ç››çš„æ™šé¤ï¼Œä¹°èœåšé¥­æ´—ç¢—æ‰“æ‰«å«ç”Ÿ')">
                            ç”Ÿæ´»ä»»åŠ¡
                        </button>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-outline-warning btn-sm w-100 mb-2" onclick="useTestCase('è¿™ä¸ªå‘¨æœ«è¦ç­–åˆ’æœ‹å‹çš„ç”Ÿæ—¥æ´¾å¯¹ï¼Œä»åœºåœ°å¸ƒç½®åˆ°é£Ÿç‰©å‡†å¤‡éƒ½è¦å®‰æ’')">
                            å¤æ‚é¡¹ç›®
                        </button>
                    </div>
                </div>
            </div>

            <!-- æ‰‹åŠ¨è¾“å…¥æµ‹è¯• -->
            <div class="mb-4">
                <h6 class="section-title">âœï¸ æ‰‹åŠ¨è¾“å…¥æµ‹è¯•</h6>
                <div class="row">
                    <div class="col-md-8">
                        <input type="text" class="form-control" id="manual-input"
                               placeholder="è¾“å…¥ä»»åŠ¡æè¿°ï¼Œç‚¹å‡»æµ‹è¯•AIæ‹†åˆ†...">
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-primary w-100" onclick="testAIOnly()">
                            æµ‹è¯•AIæ‹†åˆ†
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // å…¨å±€å˜é‡
        let isRecording = false;
        let testCount = 0;
        let successCount = 0;

        // æ›´æ–°çŠ¶æ€æ—¥å¿—
        function updateStatus(message, type = 'info') {
            const statusLog = document.getElementById('status-log');
            const timestamp = new Date().toLocaleTimeString();
            const alertClass = type === 'success' ? 'alert-success' :
                             type === 'error' ? 'alert-danger' : 'alert-info';

            statusLog.innerHTML = `
                <div class="alert ${alertClass} py-2">
                    <small>[${timestamp}] ${message}</small>
                </div>
            `;
        }

        // æ›´æ–°APIçŠ¶æ€
        function updateAPIStatus(api, status) {
            const element = document.getElementById(api + '-status');
            element.className = `api-status status-${status}`;

            const statusText = {
                'connected': 'å·²è¿æ¥',
                'disconnected': 'æœªè¿æ¥',
                'testing': 'æµ‹è¯•ä¸­',
                'error': 'è¿æ¥å¤±è´¥'
            };

            element.textContent = `${api === 'xfyun' ? 'ç§‘å¤§è®¯é£' : 'ç™¾åº¦AI'}: ${statusText[status]}`;
        }

        // æ›´æ–°æµ‹è¯•ç»Ÿè®¡
        function updateStats(success) {
            testCount++;
            if (success) successCount++;

            document.getElementById('test-count').textContent = testCount;
            document.getElementById('success-rate').textContent =
                testCount > 0 ? Math.round(successCount / testCount * 100) + '%' : '0%';
        }

        // å½•éŸ³æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        document.getElementById('record-btn').addEventListener('click', function() {
            if (!isRecording) {
                startRecording();
            } else {
                stopRecording();
            }
        });

        // å¼€å§‹å½•éŸ³
        function startRecording() {
            const btn = document.getElementById('record-btn');
            const btnText = document.getElementById('btn-text');
            const btnStatus = document.getElementById('btn-status');

            isRecording = true;
            btn.classList.add('recording');
            btnText.textContent = 'å½•éŸ³ä¸­...';
            btnStatus.textContent = 'ç‚¹å‡»åœæ­¢';

            updateStatus('ğŸ¤ å¼€å§‹å½•éŸ³...', 'info');

            // TODO: é›†æˆå®é™…çš„è¯­éŸ³è¯†åˆ«API
            // è¿™é‡Œå…ˆç”¨æ¨¡æ‹Ÿæ•°æ®
            setTimeout(() => {
                simulateVoiceRecognition();
            }, 3000);
        }

        // åœæ­¢å½•éŸ³
        function stopRecording() {
            const btn = document.getElementById('record-btn');
            const btnText = document.getElementById('btn-text');
            const btnStatus = document.getElementById('btn-status');

            isRecording = false;
            btn.classList.remove('recording');
            btnText.textContent = 'å¤„ç†ä¸­...';
            btnStatus.textContent = 'è¯·ç¨å€™';

            updateStatus('â¸ï¸ å½•éŸ³ç»“æŸï¼Œæ­£åœ¨å¤„ç†...', 'info');
        }

        // æ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«ï¼ˆå®é™…å¼€å‘æ—¶æ›¿æ¢ä¸ºçœŸå®APIè°ƒç”¨ï¼‰
        function simulateVoiceRecognition() {
            stopRecording();

            const testTexts = [
                'ä»Šå¤©ä¸‹åˆä¸‰ç‚¹è¦å¼€äº§å“è¯„å®¡ä¼šè®®ï¼Œéœ€è¦å‡†å¤‡PPTå’Œæ•°æ®æŠ¥å‘Š',
                'æ˜å¤©è¦å‡†å¤‡ä¸€é¡¿ä¸°ç››çš„æ™šé¤ï¼Œä¹°èœåšé¥­æ´—ç¢—æ‰“æ‰«å«ç”Ÿ',
                'è¿™ä¸ªå‘¨æœ«è¦ç­–åˆ’æœ‹å‹çš„ç”Ÿæ—¥æ´¾å¯¹ï¼Œä»åœºåœ°å¸ƒç½®åˆ°é£Ÿç‰©å‡†å¤‡éƒ½è¦å®‰æ’'
            ];

            const randomText = testTexts[Math.floor(Math.random() * testTexts.length)];

            // æ˜¾ç¤ºè¯­éŸ³è¯†åˆ«ç»“æœ
            document.getElementById('voice-result').innerHTML = `
                <div class="alert alert-info">
                    <strong>è¯†åˆ«ç»“æœ:</strong><br>
                    ${randomText}
                </div>
            `;

            updateStatus('âœ… è¯­éŸ³è¯†åˆ«å®Œæˆï¼Œå¼€å§‹AIæ‹†åˆ†...', 'success');
            updateStats(true);

            // è°ƒç”¨AIæ‹†åˆ†
            setTimeout(() => {
                testAITaskSplit(randomText);
            }, 1000);
        }

        // æµ‹è¯•AIä»»åŠ¡æ‹†åˆ†
        function testAITaskSplit(taskText) {
            updateStatus('ğŸ¤– æ­£åœ¨è°ƒç”¨AIè¿›è¡Œä»»åŠ¡æ‹†åˆ†...', 'info');
            updateAPIStatus('baidu', 'testing');

            // TODO: é›†æˆå®é™…çš„AI API
            // è¿™é‡Œå…ˆç”¨æ¨¡æ‹Ÿæ‹†åˆ†ç»“æœ
            const mockResults = {
                'ä»Šå¤©ä¸‹åˆä¸‰ç‚¹è¦å¼€äº§å“è¯„å®¡ä¼šè®®ï¼Œéœ€è¦å‡†å¤‡PPTå’Œæ•°æ®æŠ¥å‘Š': [
                    'æ•´ç†äº§å“åŠŸèƒ½æ¸…å•',
                    'åˆ¶ä½œæ¼”ç¤ºPPT',
                    'å‡†å¤‡ç”¨æˆ·æ•°æ®æŠ¥å‘Š',
                    'å‡†å¤‡ç«å“åˆ†æææ–™',
                    'é¢„çº¦ä¼šè®®å®¤',
                    'é€šçŸ¥å‚ä¼šäººå‘˜'
                ],
                'æ˜å¤©è¦å‡†å¤‡ä¸€é¡¿ä¸°ç››çš„æ™šé¤ï¼Œä¹°èœåšé¥­æ´—ç¢—æ‰“æ‰«å«ç”Ÿ': [
                    'è§„åˆ’èœå•å’Œè´­ç‰©æ¸…å•',
                    'å»è¶…å¸‚è´­ä¹°é£Ÿæ',
                    'æ¸…æ´—å’Œåˆ‡é…è”¬èœ',
                    'çƒ¹é¥ªä¸»èœå’Œé…èœ',
                    'å‡†å¤‡é¤å…·å’Œé¥®æ–™',
                    'é¤åæ´—ç¢—å’Œæ‰“æ‰«'
                ],
                'è¿™ä¸ªå‘¨æœ«è¦ç­–åˆ’æœ‹å‹çš„ç”Ÿæ—¥æ´¾å¯¹ï¼Œä»åœºåœ°å¸ƒç½®åˆ°é£Ÿç‰©å‡†å¤‡éƒ½è¦å®‰æ’': [
                    'ç¡®å®šæ´¾å¯¹æ—¥æœŸå’Œé‚€è¯·åå•',
                    'é¢„è®¢æ´¾å¯¹åœºåœ°æˆ–å¸ƒç½®å®¶ä¸­',
                    'åˆ¶å®šæ´¾å¯¹æµç¨‹å’Œæ´»åŠ¨å®‰æ’',
                    'è®¢è´­ç”Ÿæ—¥è›‹ç³•å’Œå‡†å¤‡é£Ÿç‰©',
                    'è´­ä¹°è£…é¥°ç”¨å“å’Œç”Ÿæ—¥ç¤¼ç‰©',
                    'å®‰æ’éŸ³ä¹å’Œå¨±ä¹æ´»åŠ¨'
                ]
            };

            const result = mockResults[taskText] || ['ä»»åŠ¡æ‹†åˆ†ä¸­...'];

            // æ˜¾ç¤ºAIæ‹†åˆ†ç»“æœ
            setTimeout(() => {
                displayTaskList(result);
                document.getElementById('ai-result').innerHTML = `
                    <div class="alert alert-success">
                        <strong>æ‹†åˆ†å®Œæˆ:</strong><br>
                        å·²å°†ä»»åŠ¡æ‹†åˆ†ä¸º ${result.length} ä¸ªå­ä»»åŠ¡
                    </div>
                `;

                updateStatus('ğŸ‰ AIä»»åŠ¡æ‹†åˆ†å®Œæˆï¼', 'success');
                updateAPIStatus('baidu', 'connected');

                // é‡ç½®æŒ‰é’®çŠ¶æ€
                const btn = document.getElementById('record-btn');
                const btnText = document.getElementById('btn-text');
                const btnStatus = document.getElementById('btn-status');
                btnText.textContent = 'ç‚¹å‡»å½•éŸ³';
                btnStatus.textContent = 'å‡†å¤‡å°±ç»ª';

            }, 2000);
        }

        // æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨
        function displayTaskList(tasks) {
            const taskList = document.getElementById('task-list');
            let html = '';

            tasks.forEach((task, index) => {
                html += `
                    <div class="task-item">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="task-${index}">
                            <label class="form-check-label" for="task-${index}">
                                ${task}
                            </label>
                        </div>
                    </div>
                `;
            });

            taskList.innerHTML = html;
        }

        // ä½¿ç”¨æµ‹è¯•ç”¨ä¾‹
        function useTestCase(text) {
            document.getElementById('manual-input').value = text;
            testAIOnly();
        }

        // ä»…æµ‹è¯•AIæ‹†åˆ†åŠŸèƒ½
        function testAIOnly() {
            const input = document.getElementById('manual-input').value;
            if (!input.trim()) {
                updateStatus('âš ï¸ è¯·è¾“å…¥ä»»åŠ¡æè¿°', 'error');
                return;
            }

            updateStatus('ğŸ§ª å¼€å§‹AIæ‹†åˆ†æµ‹è¯•...', 'info');
            document.getElementById('voice-result').innerHTML = `
                <div class="alert alert-secondary">
                    <strong>æ‰‹åŠ¨è¾“å…¥:</strong><br>
                    ${input}
                </div>
            `;

            testAITaskSplit(input);
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('ğŸš€ TaskAI Demo å·²åŠ è½½ï¼Œå‡†å¤‡å¼€å§‹æµ‹è¯•...', 'info');

            // æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒWeb Speech APIï¼ˆä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆï¼‰
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                updateStatus('âœ… æµè§ˆå™¨æ”¯æŒWeb Speech APIï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰', 'success');
            } else {
                updateStatus('âš ï¸ æµè§ˆå™¨ä¸æ”¯æŒWeb Speech APIï¼Œéœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹API', 'error');
            }
        });

        // æ¨¡æ‹ŸAPIè¿æ¥æ£€æµ‹
        setTimeout(() => {
            updateAPIStatus('xfyun', 'testing');
            setTimeout(() => {
                updateAPIStatus('xfyun', 'connected');
                updateStatus('ğŸ”— ç§‘å¤§è®¯é£APIè¿æ¥æµ‹è¯•æˆåŠŸ', 'success');
            }, 1000);
        }, 2000);
    </script>
</body>
</html>